rule WinKeypassMalware {
    meta:
        description = "Rule to detect WinKeypass malware"
        author = "Rachana"
        date = "4/25/2023"
    strings:
        $s1 = "kronus.pp.ua/upwinload/get.php" ascii wide nocase
        $s2 = "delself.bat" ascii wide nocase
        $s3 = "DECRYPTION_KEYPASS_INFO.txt" ascii wide nocase
        $s4 = "G:\\Doc\\My work (C++)\\_New 2018\\Encryption\\Release\\encrypt.pdb" ascii wide nocase
        $s5 = "G:\\FromInet\\Include\\boost_1_65_1" ascii wide nocase
        $s6 = "KEYPASS" ascii wide nocase
        $s7 = "keypassdecrypt@india.com" ascii wide nocase
        $s8 = "Ramsil" ascii wide nocase

        $x1 = "rdpclip.exe" ascii wide nocase
        $x2 = "GetTickCount" ascii wide nocase
        $x3 = "IsDebuggerPresent" ascii wide nocase
        $x4 = "SetWindowsHookEx" ascii wide nocase
        $x5 = "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Network" ascii wide nocase
        $x6 = "asInvoker" ascii wide nocase

    condition:
        uint16(0) == 0x5a4d and filesize < 2890KB and (5 of ($s*) and 4 of ($x*))
}