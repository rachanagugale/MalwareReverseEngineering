rule ManyBytesMalware {
    meta:
        description = "Rule to detect practical3 malware"
        author = "Rachana"
        date = "4/7/2023"
    strings:
        $s1 = "Msisoft" ascii wide nocase
        $s2 = "ManyBytes program" ascii wide nocase
        $s3 = "ManyBytes.exe" ascii wide nocase
        $s4 = "OriginalFilename" ascii wide nocase
        $s5 = "screenssanges" ascii wide nocase
        $s6 = "guikas.txt" ascii wide nocase
        $s7 = "@Od@ddx0x0" ascii wide nocase
        $s8 = "zolupalim" ascii wide nocase
        $s9 = "Add page %s to favorites with (optional) name" ascii wide nocase

        $x1 = "GPLv3" ascii wide nocase
        $x2 = "<program name unknown>" ascii wide nocase
        $x3 = "SING error" ascii wide nocase
        $x4 = "VarFileInfo" ascii wide nocase
        $x5 = "1.1.21.11" ascii wide nocase

    condition:
        uint16(0) == 0x5a4d and filesize < 120KB and (6 of ($s*) and 3 of ($x*))
}